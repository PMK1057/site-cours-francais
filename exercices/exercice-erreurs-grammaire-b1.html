    <button class="back-btn" onclick="backToSection('exercices')">‚Üê Retour</button>
    
    <h2>üîç Erreurs de Grammaire - Niveau B1/B2 - Anglais ‚Üí Fran√ßais</h2>

    <div class="exercise translation-exercise">
        <div class="game-card translation-card">
            <div class="game-card-body">
                <div class="translation-question">
                    <p id="grammar-question-b1"></p>
                </div>
                <div class="grammar-options" id="grammar-options-b1">
                    <!-- Les options seront g√©n√©r√©es dynamiquement -->
                </div>
                <div id="grammar-result-b1" class="translation-result" style="display: none;">
                    <p id="grammar-result-explanation-b1"></p>
                    <button id="grammar-next-b1" onclick="nextGrammarQuestionB1()">Suivant</button>
                </div>
                <div class="translation-progress">
                    <p id="grammar-progress-text-b1"></p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Liste des questions avec erreurs grammaticales avanc√©es (B1/B2)
        const grammarQuestionsB1 = [
            {
                en: "I wish you were here.",
                options: [
                    { text: "J'aimerais que tu sois ici.", correct: true },
                    { text: "J'aimerais que tu es ici.", correct: false, error: "Erreur : apr√®s 'que', utiliser le subjonctif 'sois' et non l'indicatif 'es'" },
                    { text: "J'aimerais que tu seras ici.", correct: false, error: "Erreur : apr√®s 'que', utiliser le subjonctif 'sois' et non le futur 'seras'" },
                    { text: "J'aimerais que tu √™tre ici.", correct: false, error: "Erreur : utiliser la forme conjugu√©e 'sois' (subjonctif) et non l'infinitif '√™tre'" }
                ]
            },
            {
                en: "The book that I bought yesterday is very interesting.",
                options: [
                    { text: "Le livre que j'ai achet√© hier est tr√®s int√©ressant.", correct: true },
                    { text: "Le livre que j'ai achet√©e hier est tr√®s int√©ressant.", correct: false, error: "Erreur : 'achet√©' ne s'accorde pas car le COD 'que' est plac√© apr√®s le verbe" },
                    { text: "Le livre qui j'ai achet√© hier est tr√®s int√©ressant.", correct: false, error: "Erreur : utiliser 'que' (COD) et non 'qui' (sujet) car 'livre' est l'objet de 'acheter'" },
                    { text: "Le livre dont j'ai achet√© hier est tr√®s int√©ressant.", correct: false, error: "Erreur : utiliser 'que' (COD) et non 'dont' (compl√©ment de nom)" }
                ]
            },
            {
                en: "I had already finished when you arrived.",
                options: [
                    { text: "J'avais d√©j√† fini quand tu es arriv√©.", correct: true },
                    { text: "J'ai d√©j√† fini quand tu es arriv√©.", correct: false, error: "Erreur : utiliser le plus-que-parfait 'j'avais fini' pour une action ant√©rieure √† une autre action pass√©e" },
                    { text: "Je finissais d√©j√† quand tu es arriv√©.", correct: false, error: "Erreur : utiliser le plus-que-parfait 'j'avais fini' (action termin√©e) et non l'imparfait 'je finissais' (action en cours)" },
                    { text: "J'avais d√©j√† fini quand tu avais arriv√©.", correct: false, error: "Erreur : avec 'arriver', utiliser '√™tre' (tu es) et non 'avoir' (tu as)" }
                ]
            },
            {
                en: "If I had time, I would travel more.",
                options: [
                    { text: "Si j'avais le temps, je voyagerais plus.", correct: true },
                    { text: "Si j'ai le temps, je voyagerais plus.", correct: false, error: "Erreur : dans une hypoth√®se irr√©elle, utiliser l'imparfait 'j'avais' et non le pr√©sent 'j'ai'" },
                    { text: "Si j'avais le temps, je vais voyager plus.", correct: false, error: "Erreur : dans une hypoth√®se irr√©elle, utiliser le conditionnel 'je voyagerais' et non le futur 'je vais voyager'" },
                    { text: "Si j'aurais le temps, je voyagerais plus.", correct: false, error: "Erreur : apr√®s 'si', ne jamais utiliser le conditionnel, utiliser l'imparfait 'j'avais'" }
                ]
            },
            {
                en: "The letters that I sent were received.",
                options: [
                    { text: "Les lettres que j'ai envoy√©es ont √©t√© re√ßues.", correct: true },
                    { text: "Les lettres que j'ai envoy√© ont √©t√© re√ßues.", correct: false, error: "Erreur : 'envoy√©es' s'accorde avec 'lettres' car le COD 'que' est plac√© avant le verbe" },
                    { text: "Les lettres que j'ai envoy√©es a √©t√© re√ßues.", correct: false, error: "Erreur : 'ont √©t√©' (pluriel) car le sujet 'lettres' est au pluriel" },
                    { text: "Les lettres que j'ai envoy√©es ont √©t√© re√ßu.", correct: false, error: "Erreur : 're√ßues' s'accorde avec 'lettres' (f√©minin pluriel)" }
                ]
            },
            {
                en: "It's necessary that he comes.",
                options: [
                    { text: "Il faut qu'il vienne.", correct: true },
                    { text: "Il faut qu'il vient.", correct: false, error: "Erreur : apr√®s 'il faut que', utiliser le subjonctif 'vienne' et non l'indicatif 'vient'" },
                    { text: "Il faut qu'il viendra.", correct: false, error: "Erreur : apr√®s 'il faut que', utiliser le subjonctif 'vienne' et non le futur 'viendra'" },
                    { text: "Il faut qu'il venir.", correct: false, error: "Erreur : utiliser la forme conjugu√©e 'vienne' (subjonctif) et non l'infinitif 'venir'" }
                ]
            },
            {
                en: "While reading, I fell asleep.",
                options: [
                    { text: "En lisant, je me suis endormi.", correct: true },
                    { text: "Pendant lisant, je me suis endormi.", correct: false, error: "Erreur : utiliser le g√©rondif 'en lisant' et non 'pendant lisant'" },
                    { text: "En lire, je me suis endormi.", correct: false, error: "Erreur : utiliser le g√©rondif 'en lisant' (participe pr√©sent) et non 'en lire' (infinitif)" },
                    { text: "En lisant, je suis endormi.", correct: false, error: "Erreur : avec 's'endormir', utiliser 'je me suis endormi' (pass√© compos√© pronominal)" }
                ]
            },
            {
                en: "The house was built last year.",
                options: [
                    { text: "La maison a √©t√© construite l'ann√©e derni√®re.", correct: true },
                    { text: "La maison √©tait construite l'ann√©e derni√®re.", correct: false, error: "Erreur : utiliser 'a √©t√© construite' (passif au pass√© compos√©) et non '√©tait construite' (imparfait)" },
                    { text: "La maison a √©t√© construit l'ann√©e derni√®re.", correct: false, error: "Erreur : 'construite' s'accorde avec 'maison' (f√©minin)" },
                    { text: "La maison a construite l'ann√©e derni√®re.", correct: false, error: "Erreur : utiliser la voix passive 'a √©t√© construite' et non 'a construite'" }
                ]
            },
            {
                en: "I would have come if I had known.",
                options: [
                    { text: "Je serais venu si j'avais su.", correct: true },
                    { text: "Je suis venu si j'avais su.", correct: false, error: "Erreur : utiliser le conditionnel pass√© 'je serais venu' pour une action non r√©alis√©e dans le pass√©" },
                    { text: "Je serais venu si je savais.", correct: false, error: "Erreur : dans une hypoth√®se pass√©e, utiliser le plus-que-parfait 'j'avais su' et non l'imparfait 'je savais'" },
                    { text: "Je serais venir si j'avais su.", correct: false, error: "Erreur : utiliser le participe pass√© 'venu' et non l'infinitif 'venir' dans le conditionnel pass√©" }
                ]
            },
            {
                en: "The people I spoke to were very kind.",
                options: [
                    { text: "Les personnes √† qui j'ai parl√© √©taient tr√®s gentilles.", correct: true },
                    { text: "Les personnes que j'ai parl√© √©taient tr√®s gentilles.", correct: false, error: "Erreur : utiliser '√† qui' (COI) car 'parler' se construit avec '√†' (parler √† quelqu'un)" },
                    { text: "Les personnes dont j'ai parl√© √©taient tr√®s gentilles.", correct: false, error: "Erreur : utiliser '√† qui' (COI) et non 'dont' (compl√©ment de nom)" },
                    { text: "Les personnes √† qui j'ai parl√©es √©taient tr√®s gentilles.", correct: false, error: "Erreur : 'parl√©' ne s'accorde pas car '√† qui' est un COI, pas un COD" }
                ]
            },
            {
                en: "I'm afraid that he won't come.",
                options: [
                    { text: "J'ai peur qu'il ne vienne pas.", correct: true },
                    { text: "J'ai peur qu'il ne vient pas.", correct: false, error: "Erreur : apr√®s 'avoir peur que', utiliser le subjonctif 'vienne' et non l'indicatif 'vient'" },
                    { text: "J'ai peur qu'il vienne pas.", correct: false, error: "Erreur : avec 'avoir peur que', utiliser la n√©gation 'ne...pas' avec le 'ne' expl√©tif" },
                    { text: "J'ai peur qu'il ne viendra pas.", correct: false, error: "Erreur : apr√®s 'avoir peur que', utiliser le subjonctif 'vienne' et non le futur 'viendra'" }
                ]
            },
            {
                en: "The movie that we saw was excellent.",
                options: [
                    { text: "Le film que nous avons vu √©tait excellent.", correct: true },
                    { text: "Le film que nous avons vus √©tait excellent.", correct: false, error: "Erreur : 'vu' ne s'accorde pas car le COD 'que' est plac√© apr√®s le verbe" },
                    { text: "Le film qui nous avons vu √©tait excellent.", correct: false, error: "Erreur : utiliser 'que' (COD) et non 'qui' (sujet) car 'film' est l'objet de 'voir'" },
                    { text: "Le film que nous avons vue √©tait excellent.", correct: false, error: "Erreur : 'vu' ne s'accorde pas et reste invariable car le COD est apr√®s le verbe" }
                ]
            },
            {
                en: "Before leaving, she closed the windows.",
                options: [
                    { text: "Avant de partir, elle a ferm√© les fen√™tres.", correct: true },
                    { text: "Avant partir, elle a ferm√© les fen√™tres.", correct: false, error: "Erreur : apr√®s 'avant', utiliser 'de' + infinitif 'avant de partir'" },
                    { text: "Avant de partant, elle a ferm√© les fen√™tres.", correct: false, error: "Erreur : apr√®s 'avant de', utiliser l'infinitif 'partir' et non le participe pr√©sent 'partant'" },
                    { text: "Avant partir, elle a ferm√© les fen√™tres.", correct: false, error: "Erreur : 'avant de' n√©cessite la pr√©position 'de' avant l'infinitif" }
                ]
            },
            {
                en: "I would like you to help me.",
                options: [
                    { text: "J'aimerais que tu m'aides.", correct: true },
                    { text: "J'aimerais que tu m'aide.", correct: false, error: "Erreur : apr√®s 'que', utiliser le subjonctif 'aides' (tu aides) et non l'indicatif 'aide'" },
                    { text: "J'aimerais que tu m'aideras.", correct: false, error: "Erreur : apr√®s 'que', utiliser le subjonctif 'aides' et non le futur 'aideras'" },
                    { text: "J'aimerais que tu m'aider.", correct: false, error: "Erreur : utiliser la forme conjugu√©e 'aides' (subjonctif) et non l'infinitif 'aider'" }
                ]
            },
            {
                en: "The students who passed the exam are happy.",
                options: [
                    { text: "Les √©tudiants qui ont r√©ussi l'examen sont contents.", correct: true },
                    { text: "Les √©tudiants que ont r√©ussi l'examen sont contents.", correct: false, error: "Erreur : utiliser 'qui' (sujet) et non 'que' (COD) car '√©tudiants' est le sujet de 'r√©ussir'" },
                    { text: "Les √©tudiants qui ont r√©ussi l'examen est content.", correct: false, error: "Erreur : 'sont' (pluriel) car le sujet '√©tudiants' est au pluriel" },
                    { text: "Les √©tudiants qui ont r√©ussi l'examen sont content.", correct: false, error: "Erreur : 'contents' (pluriel) car le sujet '√©tudiants' est au pluriel" }
                ]
            },
            {
                en: "It's possible that she doesn't know.",
                options: [
                    { text: "Il est possible qu'elle ne sache pas.", correct: true },
                    { text: "Il est possible qu'elle ne sait pas.", correct: false, error: "Erreur : apr√®s 'il est possible que', utiliser le subjonctif 'sache' et non l'indicatif 'sait'" },
                    { text: "Il est possible qu'elle ne saura pas.", correct: false, error: "Erreur : apr√®s 'il est possible que', utiliser le subjonctif 'sache' et non le futur 'saura'" },
                    { text: "Il est possible qu'elle ne savoir pas.", correct: false, error: "Erreur : utiliser la forme conjugu√©e 'sache' (subjonctif) et non l'infinitif 'savoir'" }
                ]
            },
            {
                en: "The car that I sold was old.",
                options: [
                    { text: "La voiture que j'ai vendue √©tait vieille.", correct: true },
                    { text: "La voiture que j'ai vendu √©tait vieille.", correct: false, error: "Erreur : 'vendue' s'accorde avec 'voiture' car le COD 'que' est plac√© avant le verbe" },
                    { text: "La voiture qui j'ai vendue √©tait vieille.", correct: false, error: "Erreur : utiliser 'que' (COD) et non 'qui' (sujet) car 'voiture' est l'objet de 'vendre'" },
                    { text: "La voiture que j'ai vendue √©tait vieux.", correct: false, error: "Erreur : 'vieille' (f√©minin) car 'voiture' est f√©minin" }
                ]
            },
            {
                en: "I regret not having studied more.",
                options: [
                    { text: "Je regrette de ne pas avoir √©tudi√© davantage.", correct: true },
                    { text: "Je regrette ne pas avoir √©tudi√© davantage.", correct: false, error: "Erreur : apr√®s 'regretter', utiliser 'de' + infinitif 'de ne pas avoir √©tudi√©'" },
                    { text: "Je regrette de ne pas √©tudier davantage.", correct: false, error: "Erreur : utiliser 'avoir √©tudi√©' (infinitif pass√©) pour une action pass√©e et non '√©tudier' (infinitif pr√©sent)" },
                    { text: "Je regrette de ne pas avoir √©tudi√©e davantage.", correct: false, error: "Erreur : '√©tudi√©' reste invariable car c'est un infinitif pass√©, pas un participe pass√©" }
                ]
            },
            {
                en: "The problem is that he doesn't understand.",
                options: [
                    { text: "Le probl√®me, c'est qu'il ne comprend pas.", correct: true },
                    { text: "Le probl√®me, c'est qu'il ne comprends pas.", correct: false, error: "Erreur : conjugaison - 'il comprend' (3e personne) et non 'il comprends' (2e personne)" },
                    { text: "Le probl√®me, c'est qu'il ne comprenne pas.", correct: false, error: "Erreur : apr√®s 'c'est que', utiliser l'indicatif 'comprend' et non le subjonctif 'comprenne'" },
                    { text: "Le probl√®me, c'est qu'il ne comprenne pas.", correct: false, error: "Erreur : 'c'est que' introduit une explication, utiliser l'indicatif et non le subjonctif" }
                ]
            },
            {
                en: "She would have succeeded if she had worked harder.",
                options: [
                    { text: "Elle aurait r√©ussi si elle avait travaill√© plus dur.", correct: true },
                    { text: "Elle aurait r√©ussi si elle travaillait plus dur.", correct: false, error: "Erreur : dans une hypoth√®se pass√©e, utiliser le plus-que-parfait 'avait travaill√©' et non l'imparfait 'travaillait'" },
                    { text: "Elle a r√©ussi si elle avait travaill√© plus dur.", correct: false, error: "Erreur : utiliser le conditionnel pass√© 'aurait r√©ussi' pour une action non r√©alis√©e dans le pass√©" },
                    { text: "Elle aurait r√©ussir si elle avait travaill√© plus dur.", correct: false, error: "Erreur : utiliser le participe pass√© 'r√©ussi' et non l'infinitif 'r√©ussir' dans le conditionnel pass√©" }
                ]
            },
            {
                en: "The children that I'm taking care of are sleeping.",
                options: [
                    { text: "Les enfants dont je m'occupe dorment.", correct: true },
                    { text: "Les enfants que je m'occupe dorment.", correct: false, error: "Erreur : utiliser 'dont' car 's'occuper' se construit avec 'de' (s'occuper de)" },
                    { text: "Les enfants qui je m'occupe dorment.", correct: false, error: "Erreur : utiliser 'dont' (compl√©ment de nom avec 'de') et non 'qui' (sujet)" },
                    { text: "Les enfants dont je m'occupe dort.", correct: false, error: "Erreur : 'dorment' (pluriel) car le sujet 'enfants' est au pluriel" }
                ]
            },
            {
                en: "It's important that you be on time.",
                options: [
                    { text: "Il est important que tu sois √† l'heure.", correct: true },
                    { text: "Il est important que tu es √† l'heure.", correct: false, error: "Erreur : apr√®s 'il est important que', utiliser le subjonctif 'sois' et non l'indicatif 'es'" },
                    { text: "Il est important que tu seras √† l'heure.", correct: false, error: "Erreur : apr√®s 'il est important que', utiliser le subjonctif 'sois' et non le futur 'seras'" },
                    { text: "Il est important que tu √™tre √† l'heure.", correct: false, error: "Erreur : utiliser la forme conjugu√©e 'sois' (subjonctif) et non l'infinitif '√™tre'" }
                ]
            },
            {
                en: "The books that I read were interesting.",
                options: [
                    { text: "Les livres que j'ai lus √©taient int√©ressants.", correct: true },
                    { text: "Les livres que j'ai lu √©taient int√©ressants.", correct: false, error: "Erreur : 'lus' s'accorde avec 'livres' car le COD 'que' est plac√© avant le verbe" },
                    { text: "Les livres qui j'ai lus √©taient int√©ressants.", correct: false, error: "Erreur : utiliser 'que' (COD) et non 'qui' (sujet) car 'livres' est l'objet de 'lire'" },
                    { text: "Les livres que j'ai lus √©tait int√©ressants.", correct: false, error: "Erreur : '√©taient' (pluriel) car le sujet 'livres' est au pluriel" }
                ]
            },
            {
                en: "I'm happy that you came.",
                options: [
                    { text: "Je suis content que tu sois venu.", correct: true },
                    { text: "Je suis content que tu es venu.", correct: false, error: "Erreur : apr√®s '√™tre content que', utiliser le subjonctif 'sois venu' et non l'indicatif 'es venu'" },
                    { text: "Je suis content que tu viens.", correct: false, error: "Erreur : utiliser le subjonctif pass√© 'sois venu' pour une action pass√©e et non le pr√©sent 'viens'" },
                    { text: "Je suis content que tu sois venir.", correct: false, error: "Erreur : utiliser le participe pass√© 'venu' et non l'infinitif 'venir' dans le subjonctif pass√©" }
                ]
            },
            {
                en: "The house where I live is small.",
                options: [
                    { text: "La maison o√π j'habite est petite.", correct: true },
                    { text: "La maison que j'habite est petite.", correct: false, error: "Erreur : utiliser 'o√π' (lieu) et non 'que' (COD) car on indique un lieu" },
                    { text: "La maison qui j'habite est petite.", correct: false, error: "Erreur : utiliser 'o√π' (lieu) et non 'qui' (sujet)" },
                    { text: "La maison dont j'habite est petite.", correct: false, error: "Erreur : utiliser 'o√π' (lieu) et non 'dont' (compl√©ment de nom)" }
                ]
            },
            {
                en: "I doubt that he will come.",
                options: [
                    { text: "Je doute qu'il vienne.", correct: true },
                    { text: "Je doute qu'il vient.", correct: false, error: "Erreur : apr√®s 'douter que', utiliser le subjonctif 'vienne' et non l'indicatif 'vient'" },
                    { text: "Je doute qu'il viendra.", correct: false, error: "Erreur : apr√®s 'douter que', utiliser le subjonctif 'vienne' et non le futur 'viendra'" },
                    { text: "Je doute qu'il venir.", correct: false, error: "Erreur : utiliser la forme conjugu√©e 'vienne' (subjonctif) et non l'infinitif 'venir'" }
                ]
            },
            {
                en: "The woman I'm talking about is my teacher.",
                options: [
                    { text: "La femme dont je parle est mon professeur.", correct: true },
                    { text: "La femme que je parle est mon professeur.", correct: false, error: "Erreur : utiliser 'dont' car 'parler' se construit avec 'de' (parler de)" },
                    { text: "La femme qui je parle est mon professeur.", correct: false, error: "Erreur : utiliser 'dont' (compl√©ment de nom avec 'de') et non 'qui' (sujet)" },
                    { text: "La femme √† qui je parle est mon professeur.", correct: false, error: "Erreur : utiliser 'dont' (parler de) et non '√† qui' (parler √†)" }
                ]
            },
            {
                en: "It's better that you leave now.",
                options: [
                    { text: "Il vaut mieux que tu partes maintenant.", correct: true },
                    { text: "Il vaut mieux que tu part maintenant.", correct: false, error: "Erreur : apr√®s 'il vaut mieux que', utiliser le subjonctif 'partes' et non l'indicatif 'part'" },
                    { text: "Il vaut mieux que tu partiras maintenant.", correct: false, error: "Erreur : apr√®s 'il vaut mieux que', utiliser le subjonctif 'partes' et non le futur 'partiras'" },
                    { text: "Il vaut mieux que tu partir maintenant.", correct: false, error: "Erreur : utiliser la forme conjugu√©e 'partes' (subjonctif) et non l'infinitif 'partir'" }
                ]
            },
            {
                en: "The students that the teacher praised are happy.",
                options: [
                    { text: "Les √©tudiants que le professeur a f√©licit√©s sont contents.", correct: true },
                    { text: "Les √©tudiants que le professeur a f√©licit√© sont contents.", correct: false, error: "Erreur : 'f√©licit√©s' s'accorde avec '√©tudiants' car le COD 'que' est plac√© avant le verbe" },
                    { text: "Les √©tudiants qui le professeur a f√©licit√©s sont contents.", correct: false, error: "Erreur : utiliser 'que' (COD) et non 'qui' (sujet) car '√©tudiants' est l'objet de 'f√©liciter'" },
                    { text: "Les √©tudiants que le professeur a f√©licit√©s est content.", correct: false, error: "Erreur : 'sont' (pluriel) car le sujet '√©tudiants' est au pluriel" }
                ]
            }
        ];

        let currentGrammarIndexB1 = -1;
        let grammarScoreB1 = 0;
        let totalGrammarAnsweredB1 = 0;
        let usedGrammarQuestionsB1 = [];

        function initGrammarGameB1() {
            currentGrammarIndexB1 = -1;
            grammarScoreB1 = 0;
            totalGrammarAnsweredB1 = 0;
            usedGrammarQuestionsB1 = [];
            nextGrammarQuestionB1();
        }

        function nextGrammarQuestionB1() {
            const resultDiv = document.getElementById('grammar-result-b1');
            const questionDiv = document.getElementById('grammar-question-b1');
            const optionsDiv = document.getElementById('grammar-options-b1');
            const progressText = document.getElementById('grammar-progress-text-b1');
            
            if (resultDiv) resultDiv.style.display = 'none';
            if (optionsDiv) optionsDiv.innerHTML = '';
            
            let availableQuestions = grammarQuestionsB1.filter((_, index) => !usedGrammarQuestionsB1.includes(index));
            
            if (availableQuestions.length === 0) {
                usedGrammarQuestionsB1 = [];
                availableQuestions = grammarQuestionsB1;
            }
            
            const randomIndex = Math.floor(Math.random() * availableQuestions.length);
            const selectedQuestion = availableQuestions[randomIndex];
            currentGrammarIndexB1 = grammarQuestionsB1.indexOf(selectedQuestion);
            usedGrammarQuestionsB1.push(currentGrammarIndexB1);
            
            if (questionDiv) {
                questionDiv.textContent = selectedQuestion.en;
            }
            
            if (optionsDiv) {
                const shuffledOptions = [...selectedQuestion.options].sort(() => Math.random() - 0.5);
                
                shuffledOptions.forEach((option, index) => {
                    const optionButton = document.createElement('button');
                    optionButton.className = 'grammar-option-btn';
                    optionButton.textContent = option.text;
                    optionButton.onclick = () => selectGrammarOptionB1(option, optionButton);
                    optionsDiv.appendChild(optionButton);
                });
            }
            
            if (progressText) {
                progressText.textContent = `${usedGrammarQuestionsB1.length} / ${grammarQuestionsB1.length} questions r√©pondues`;
            }
        }

        function selectGrammarOptionB1(option, buttonElement) {
            console.log('selectGrammarOptionB1 appel√©e', option, buttonElement);
            const resultDiv = document.getElementById('grammar-result-b1');
            const resultExplanation = document.getElementById('grammar-result-explanation-b1');
            const optionsDiv = document.getElementById('grammar-options-b1');
            
            if (!resultDiv || !resultExplanation || !optionsDiv) {
                console.error('√âl√©ments DOM non trouv√©s');
                return;
            }
            
            const allButtons = optionsDiv.querySelectorAll('.grammar-option-btn');
            
            allButtons.forEach(btn => {
                btn.disabled = true;
                btn.style.pointerEvents = 'none';
            });
            
            totalGrammarAnsweredB1++;
            
            if (option.correct) {
                grammarScoreB1++;
                buttonElement.style.backgroundColor = '#4caf50';
                buttonElement.style.color = 'white';
                // Jouer le son de succ√®s
                playSuccessSound();
            } else {
                buttonElement.style.backgroundColor = '#f44336';
                buttonElement.style.color = 'white';
                allButtons.forEach(btn => {
                    const btnText = btn.textContent.trim();
                    const correctOption = grammarQuestionsB1[currentGrammarIndexB1].options.find(opt => opt.correct);
                    if (btnText === correctOption.text) {
                        btn.style.backgroundColor = '#4caf50';
                        btn.style.color = 'white';
                    }
                });
            }
            
            if (option.correct) {
                resultDiv.className = 'translation-result correct';
                resultExplanation.innerHTML = `<strong>‚úÖ Correct !</strong><br>${option.text}`;
            } else {
                resultDiv.className = 'translation-result incorrect';
                const correctOption = grammarQuestionsB1[currentGrammarIndexB1].options.find(opt => opt.correct);
                resultExplanation.innerHTML = `<strong>‚ùå Incorrect</strong><br>La bonne r√©ponse √©tait : <strong>${correctOption.text}</strong><br><small>${option.error || ''}</small>`;
            }
            
            resultDiv.style.display = 'block';
        }

        // Fonction pour jouer un son de succ√®s (identique √† celle de la traduction)
        function playSuccessSound() {
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const now = audioContext.currentTime;
                
                // Cr√©er deux oscillateurs pour un accord
                const osc1 = audioContext.createOscillator();
                const osc2 = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                osc1.connect(gainNode);
                osc2.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                // Accord majeur (Do-Mi-Sol) mais plus simple avec juste Do-Mi
                osc1.frequency.value = 523.25; // Do (C5)
                osc2.frequency.value = 659.25; // Mi (E5)
                
                osc1.type = 'sine';
                osc2.type = 'sine';
                
                // Enveloppe douce et courte
                gainNode.gain.setValueAtTime(0, now);
                gainNode.gain.linearRampToValueAtTime(0.2, now + 0.02);
                gainNode.gain.exponentialRampToValueAtTime(0.01, now + 0.25);
                
                osc1.start(now);
                osc2.start(now);
                osc1.stop(now + 0.25);
                osc2.stop(now + 0.25);
            } catch (error) {
                // Si l'API Web Audio n'est pas disponible, on ignore silencieusement
                // (certains navigateurs n√©cessitent une interaction utilisateur avant)
            }
        }

        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initGrammarGameB1);
        } else {
            setTimeout(initGrammarGameB1, 100);
        }
    </script>

    <style>
        .grammar-options {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin: 20px 0;
        }

        .grammar-option-btn {
            padding: 16px 20px;
            background: linear-gradient(135deg, #f4f1ff 0%, #e8e0f5 100%);
            border: 2px solid #764ba2;
            border-radius: 12px;
            font-size: 1em;
            color: #764ba2;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
            font-family: inherit;
        }

        .grammar-option-btn:hover:not(:disabled) {
            background: linear-gradient(135deg, #764ba2 0%, #5a3a7a 100%);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(118, 75, 162, 0.3);
        }

        .grammar-option-btn:disabled {
            opacity: 0.7;
        }

        .translation-result.correct {
            background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%);
            border: 2px solid #4caf50;
        }

        .translation-result.incorrect {
            background: linear-gradient(135deg, #ffebee 0%, #ffcdd2 100%);
            border: 2px solid #f44336;
        }
    </style>

